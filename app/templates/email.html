<!DOCTYPE html>
<html>
    <head>
        <title>Email</title>
        <link href="{{url_for('static', filename='composeButton.css')}}" rel="stylesheet">
        <link href="{{url_for('static', filename='todoList.css')}}" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />

    </head>
    <body>
        <form method="GET" action="{{ url_for('search_email') }}">
            <input type="text" name="search_query" placeholder="Search emails" />
            <input type="submit" value="Search" />
        </form>

        <a href="/home">Home</a>
        <!--Compose Button-->
        <button id="compose-btn"><i class="fa-solid fa-pencil"></i>Compose</button>
        <div id="compose-tab">
        <form action="" method="post" novalidate enctype="multipart/form-data">
          <div class="message-icon">
            <i class="fas fa-envelope"></i>
            <span>New Message</span>
          </div>
          <div id="input-field">
            <input type="text" placeholder="Recipients" name="Email">
          </div>
          <div id="input-field">
            <input type="text" placeholder="Subject" name="Subject">
          </div>
          <div id="input-field">
            <textarea name="Message" placeholder="Message" rows="10"></textarea>
          </div>
          <div id="attachment-field">
            <input type="file" name="attachment">
          </div>
          <button type="submit" class="send-btn"><i class="fas fa-paper-plane"></i></button>
        </form>
        </div>
    
        <div class="todo">
            <h1>Todo List</h1>
        <div class="linebreak"></div>
        <form action="/addTodo" method="post">
          <input type="taskInput" id="name" name="name" placeholder="Enter 
task..." required>
          <input type="date" id="date" name="date" placeholder="mm/dd" 
required>
          <button type="taskSubmit">+</button>
        </form>

        {%for task in todo_list%}
        <div class="linebreak"></div>
        <tr>
            {%if task.done==False and task.edit==False %}
            <li type="task" 
onclick='window.location.href="/updateTodo/{{task.task_id}}"'>{{task.name}}
              <div class="date">{{task.date}}</div>
              <div class="linebreak"></div>
            </li>
            <td><a type="edit" 
href="/startEdit/{{task.task_id}}">✎</a></td>
            {%elif task.done==True and task.edit==False %}
            <li type="task" class="checked" 
onclick='window.location.href="/updateTodo/{{task.task_id}}"'>{{task.name}}
              <div class="date">{{task.date}}</div>
            </li>
            <td><a type="edit" 
href="/startEdit/{{task.task_id}}">✎</a></td>
            {%else%}
            <form action="/submitEdit/{{task.task_id}}" method="post">
              <input type="editInputText" id="editInputText" 
name="editInputText" value="{{task.name}}" required>
              <input type="date" id="editInputDate" name="editInputDate" 
value="{{task.date}}" required>
              <button type="submitEdit">✎</button>
            </form>
            
            {%endif%}
            <td><a type = "delete" 
href="/deleteTodo/{{task.task_id}}">X</a></td>
        </tr>
        {%endfor%}

        </div>
      
        <script>
            var composeBtn = document.getElementById("compose-btn");
            var composeTab = document.getElementById("compose-tab");
            var closeBtn = document.createElement("span");

            closeBtn.innerHTML = "&times;";
            closeBtn.style.position = "absolute";
            closeBtn.style.top = "10px";
            closeBtn.style.right = "10px";
            closeBtn.style.fontSize = "24px";
            closeBtn.style.cursor = "pointer";

            closeBtn.onclick = function() {
                composeTab.style.display = "none";
            };

            composeBtn.onclick = function() {
                composeTab.style.display = "block";
                composeTab.appendChild(closeBtn);
            };
        </script>

        {% with messages = get_flashed_messages() %}
        {% if messages %}
            <ul>
                {% for message in messages %}
                <li>{{ message }}</li>
                {% endfor %}
            </ul>
        {% endif %}
    {% endwith %}

        <form method="post">
            <input type="submit" value="del-Acc" name="delAcc"/>
        </form>
        <p>Email Template</p>
    </body>
